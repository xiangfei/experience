# tcp  攻击


## SYNC 攻击




![sync](/images/tcp_3_sync.png)


- 服务端接收到客户端的 SYN 报文时，会将其加入到内核的「 SYN 队列」；

- 接着发送 SYN + ACK 给客户端，等待客户端回应 ACK 报文；

- 服务端接收到 ACK 报文后，从「 SYN 队列」移入到「 Accept 队列」；


![sync](/images/tcp_3_sync_attack.png)


### 如何防止SYN 攻击？
1. 限制ip连接次数：比如限制同一IP一分钟内新建立的连接数仅为10

2. 增大半连接状态的连接数容量
但是增大内存资源占用，不推荐。

3. 延迟分配连接资源
当服务器收到第一次握手请求时，不马上分配TCP连接资源。而是计算一个随机值，在第二次握手时传给客户端，当客户端返回第三次握手时，服务器验证随机值的正确性，确认无误才会进入 TCP 的连接状态，才会分配资源。


> [!TIP]如果是恶意攻击者发送的大量SYN报文，只要服务器不为其分配资源，也不至于遭到严重破坏了。





## RST 攻击



## 会话劫持